<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-WJH7BVEQ5F"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-WJH7BVEQ5F');
    </script>
    <!-- TikTok Pixel Code Start -->
    <script>
    !function (w, d, t) {
      w.TiktokAnalyticsObject=t;var ttq=w[t]=w[t]||[];ttq.methods=["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie","disableCookie","holdConsent","revokeConsent","grantConsent"],ttq.setAndDefer=function(t,e){t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}};for(var i=0;i<ttq.methods.length;i++)ttq.setAndDefer(ttq,ttq.methods[i]);ttq.instance=function(t){for(
      var e=ttq._i[t]||[],n=0;n<ttq.methods.length;n++)ttq.setAndDefer(e,ttq.methods[n]);return e},ttq.load=function(e,n){var r="https://analytics.tiktok.com/i18n/pixel/events.js",o=n&&n.partner;ttq._i=ttq._i||{},ttq._i[e]=[],ttq._i[e]._u=r,ttq._t=ttq._t||{},ttq._t[e]=+new Date,ttq._o=ttq._o||{},ttq._o[e]=n||{};n=document.createElement("script")
      ;n.type="text/javascript",n.async=!0,n.src=r+"?sdkid="+e+"&lib="+t;e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(n,e)};
      ttq.load('D67MV7RC77U42FK01HIG');
      ttq.page();
    }(window, document, 'ttq');
    </script>
    <!-- TikTok Pixel Code End -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}HeroesAndMore - The Premium Collectables Marketplace and Auction House{% endblock %}</title>
    <meta name="description" content="{% block meta_description %}HeroesAndMore - The Premium Collectables Marketplace and Auction House. Buy, sell, and collect comics, cards, toys, and more.{% endblock %}">
    {% block robots %}{% endblock %}
    <link rel="canonical" href="{% block canonical %}{{ request.build_absolute_uri }}{% endblock %}">
    <meta property="og:title" content="{% block og_title %}HeroesAndMore - The Premium Collectables Marketplace and Auction House{% endblock %}">
    <meta property="og:description" content="{% block og_description %}The Premium Collectables Marketplace and Auction House. Buy, sell, and collect comics, cards, toys, and more.{% endblock %}">
    <meta property="og:type" content="{% block og_type %}website{% endblock %}">
    <meta property="og:url" content="{{ request.build_absolute_uri }}">
    <meta property="og:site_name" content="HeroesAndMore">
    <meta property="og:image" content="{% block og_image %}{{ default_og_image }}{% endblock %}">
    <meta name="twitter:card" content="{% block twitter_card %}summary_large_image{% endblock %}">
    <meta name="google-site-verification" content="xyMDHqFJ09pl9Dki2R7m4yxguaDuXTN2Z_GJgDrHyTY">

    <!-- Frontend Error Logging - must be first to catch all errors -->
    <script>
    (function() {
        window.onerror = function(message, source, lineno, colno, error) {
            try {
                fetch('/api/log-error/', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        message: message,
                        source: source,
                        lineno: lineno,
                        colno: colno,
                        error: error ? error.stack : '',
                        url: window.location.href,
                        userAgent: navigator.userAgent
                    })
                });
            } catch(e) {}
            return false;
        };
        window.addEventListener('unhandledrejection', function(event) {
            try {
                fetch('/api/log-error/', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        message: 'Unhandled Promise Rejection: ' + (event.reason || 'unknown'),
                        source: 'promise',
                        lineno: 0,
                        colno: 0,
                        error: event.reason && event.reason.stack ? event.reason.stack : '',
                        url: window.location.href,
                        userAgent: navigator.userAgent
                    })
                });
            } catch(e) {}
        });
    })();
    </script>

    <!-- Favicon -->
    {% load static %}
    <link rel="icon" type="image/x-icon" href="{% static 'images/favicon.ico' %}">
    <link rel="apple-touch-icon" sizes="180x180" href="{% static 'images/apple-touch-icon.png' %}">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">

    <style>
        :root {
            /* Grayscale Palette */
            --gray-50: #FAFAFA;
            --gray-100: #F5F5F5;
            --gray-200: #E5E5E5;
            --gray-300: #D4D4D4;
            --gray-400: #A3A3A3;
            --gray-500: #737373;
            --gray-600: #525252;
            --gray-700: #404040;
            --gray-800: #262626;
            --gray-900: #171717;
            --gray-950: #0A0A0A;

            /* Semantic Colors */
            --bg-primary: var(--gray-50);
            --bg-secondary: #FFFFFF;
            --bg-dark: var(--gray-900);
            --text-primary: var(--gray-900);
            --text-secondary: var(--gray-600);
            --text-muted: var(--gray-400);
            --border-color: var(--gray-200);
            --border-dark: var(--gray-300);

            /* Accent - Keep minimal color for key actions */
            --accent-success: #16A34A;
            --accent-danger: #DC2626;
            --accent-warning: #D97706;

            /* Shadows */
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
            --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -2px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -4px rgba(0,0,0,0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0,0,0,0.1), 0 8px 10px -6px rgba(0,0,0,0.1);
        }

        * {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        body {
            background-color: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        main {
            flex: 1;
        }

        /* Typography */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 700;
            letter-spacing: -0.02em;
            color: var(--text-primary);
        }

        .text-muted {
            color: var(--text-muted) !important;
        }

        .text-secondary {
            color: var(--text-secondary) !important;
        }

        /* Navbar - Clean, minimal */
        .navbar {
            background-color: #FFFFFF !important;
            border-bottom: 1px solid var(--border-color);
            padding: 0.75rem 0;
        }

        .navbar-brand {
            font-weight: 800;
            font-size: 1.35rem;
            color: var(--gray-900) !important;
            letter-spacing: -0.03em;
        }

        .navbar-brand:hover {
            color: var(--gray-700) !important;
        }

        .nav-link {
            color: var(--gray-600) !important;
            font-weight: 500;
            font-size: 0.9rem;
            padding: 0.5rem 1rem !important;
            transition: color 0.15s;
        }

        .nav-link:hover {
            color: var(--gray-900) !important;
        }

        .navbar .dropdown-menu {
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-lg);
            border-radius: 0.5rem;
            padding: 0.5rem;
        }

        .navbar .dropdown-item {
            border-radius: 0.375rem;
            padding: 0.5rem 0.75rem;
            font-size: 0.875rem;
            color: var(--gray-700);
        }

        .navbar .dropdown-item:hover {
            background-color: var(--gray-100);
            color: var(--gray-900);
        }

        .navbar .dropdown-item i {
            width: 1.25rem;
            margin-right: 0.5rem;
            color: var(--gray-400);
        }

        /* Search Bar */
        .search-container {
            max-width: 480px;
            width: 100%;
        }

        .search-input {
            background-color: var(--gray-100);
            border: 1px solid transparent;
            border-radius: 0.5rem;
            padding: 0.625rem 1rem;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .search-input:focus {
            background-color: #fff;
            border-color: var(--gray-300);
            box-shadow: var(--shadow-md);
            outline: none;
        }

        .search-input::placeholder {
            color: var(--gray-400);
        }

        /* Buttons */
        .btn-dark {
            background-color: var(--gray-900);
            border-color: var(--gray-900);
            font-weight: 600;
            padding: 0.5rem 1.25rem;
            border-radius: 0.5rem;
            transition: all 0.15s;
        }

        .btn-dark:hover {
            background-color: var(--gray-800);
            border-color: var(--gray-800);
            transform: translateY(-1px);
        }

        .btn-outline-dark {
            border-color: var(--gray-300);
            color: var(--gray-700);
            font-weight: 500;
            padding: 0.5rem 1.25rem;
            border-radius: 0.5rem;
        }

        .btn-outline-dark:hover {
            background-color: var(--gray-900);
            border-color: var(--gray-900);
            color: #fff;
        }

        .btn-ghost {
            background: transparent;
            border: none;
            color: var(--gray-600);
            padding: 0.5rem;
            border-radius: 0.375rem;
        }

        .btn-ghost:hover {
            background-color: var(--gray-100);
            color: var(--gray-900);
        }

        /* Cards - Premium feel */
        .card {
            background: #FFFFFF;
            border: 1px solid var(--border-color);
            border-radius: 0.75rem;
            overflow: hidden;
            transition: all 0.2s ease;
        }

        .card:hover {
            border-color: var(--border-dark);
            box-shadow: var(--shadow-lg);
        }

        /* Listing Cards */
        .listing-card {
            position: relative;
            background: #FFFFFF;
            border: 1px solid var(--border-color);
            border-radius: 0.75rem;
            overflow: hidden;
            transition: all 0.25s ease;
        }

        .listing-card:hover {
            border-color: var(--gray-400);
            box-shadow: var(--shadow-xl);
            transform: translateY(-4px);
        }

        .listing-card .card-img-container {
            position: relative;
            aspect-ratio: 1;
            overflow: hidden;
            background: var(--gray-100);
        }

        .listing-card .card-img-top {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .listing-card:hover .card-img-top {
            transform: scale(1.05);
        }

        .listing-card .card-actions {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            opacity: 0;
            transform: translateX(10px);
            transition: all 0.2s ease;
        }

        .listing-card:hover .card-actions {
            opacity: 1;
            transform: translateX(0);
        }

        .listing-card .action-btn {
            width: 36px;
            height: 36px;
            background: rgba(255,255,255,0.95);
            border: none;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gray-700);
            cursor: pointer;
            transition: all 0.15s;
            box-shadow: var(--shadow-md);
        }

        .listing-card .action-btn:hover {
            background: var(--gray-900);
            color: #fff;
        }

        .listing-card .card-body {
            padding: 1rem;
        }

        .listing-card .card-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: 0.5rem;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .listing-card .card-title a {
            color: inherit;
            text-decoration: none;
        }

        .listing-card .card-title a:hover {
            color: var(--gray-600);
        }

        .listing-card .price {
            font-size: 1.125rem;
            font-weight: 700;
            color: var(--gray-900);
        }

        .listing-card .price.auction {
            color: var(--accent-danger);
        }

        .listing-card .seller-info {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .listing-card .seller-info a {
            color: var(--gray-600);
            text-decoration: none;
        }

        .listing-card .seller-info a:hover {
            color: var(--gray-900);
            text-decoration: underline;
        }

        /* Badges */
        .badge {
            font-weight: 600;
            font-size: 0.7rem;
            padding: 0.35rem 0.6rem;
            border-radius: 0.375rem;
            text-transform: uppercase;
            letter-spacing: 0.03em;
        }

        .badge-condition {
            background-color: var(--gray-100);
            color: var(--gray-700);
        }

        .badge-grade {
            background-color: var(--gray-900);
            color: #fff;
        }

        .badge-auction {
            background-color: var(--accent-danger);
            color: #fff;
        }

        .badge-verified {
            background-color: var(--accent-success);
            color: #fff;
        }

        /* Time remaining */
        .time-remaining {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--accent-danger);
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        /* Category Cards */
        .category-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1.5rem 1rem;
            background: #FFFFFF;
            border: 1px solid var(--border-color);
            border-radius: 0.75rem;
            text-decoration: none;
            color: var(--text-primary);
            transition: all 0.2s ease;
        }

        .category-card:hover {
            border-color: var(--gray-400);
            background: var(--gray-50);
            transform: translateY(-2px);
            color: var(--text-primary);
        }

        .category-card .icon {
            font-size: 2rem;
            margin-bottom: 0.75rem;
            color: var(--gray-600);
        }

        .category-card .name {
            font-size: 0.85rem;
            font-weight: 600;
            text-align: center;
        }

        /* Sections */
        .section {
            padding: 4rem 0;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .section-alt {
            background-color: #FFFFFF;
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(180deg, var(--gray-900) 0%, var(--gray-800) 100%);
            color: #fff;
            padding: 5rem 0;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.03'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            opacity: 0.5;
        }

        .hero h1 {
            font-size: 3.5rem;
            font-weight: 800;
            letter-spacing: -0.03em;
            line-height: 1.1;
            color: #fff;
            margin-bottom: 1.5rem;
        }

        .hero .lead {
            font-size: 1.25rem;
            color: var(--gray-300);
            font-weight: 400;
            max-width: 500px;
        }

        .hero .btn-light {
            background: #fff;
            color: var(--gray-900);
            font-weight: 600;
            padding: 0.75rem 2rem;
            border-radius: 0.5rem;
            border: none;
        }

        .hero .btn-light:hover {
            background: var(--gray-100);
        }

        .hero .btn-outline-light {
            border: 2px solid rgba(255,255,255,0.3);
            color: #fff;
            font-weight: 600;
            padding: 0.75rem 2rem;
            border-radius: 0.5rem;
        }

        .hero .btn-outline-light:hover {
            background: rgba(255,255,255,0.1);
            border-color: rgba(255,255,255,0.5);
        }

        /* Stats Bar */
        .stats-bar {
            background: #fff;
            border-bottom: 1px solid var(--border-color);
            padding: 1rem 0;
        }

        .stat-item {
            text-align: center;
            padding: 0 1rem;
            border-right: 1px solid var(--border-color);
        }

        .stat-item:last-child {
            border-right: none;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--gray-900);
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Features */
        .feature-card {
            text-align: center;
            padding: 2rem;
        }

        .feature-icon {
            width: 64px;
            height: 64px;
            background: var(--gray-100);
            border-radius: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.25rem;
            font-size: 1.5rem;
            color: var(--gray-700);
        }

        .feature-title {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 0.75rem;
        }

        .feature-desc {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.6;
        }

        /* Footer */
        footer {
            background-color: var(--gray-900);
            color: var(--gray-300);
            padding: 4rem 0 2rem;
        }

        footer h5, footer h6 {
            color: #fff;
            font-size: 0.9rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 1.25rem;
        }

        footer ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        footer li {
            margin-bottom: 0.75rem;
        }

        footer a {
            color: var(--gray-400);
            text-decoration: none;
            font-size: 0.9rem;
            transition: color 0.15s;
        }

        footer a:hover {
            color: #fff;
        }

        footer .footer-brand {
            font-size: 1.5rem;
            font-weight: 800;
            color: #fff;
            margin-bottom: 1rem;
            display: block;
        }

        footer .footer-desc {
            color: var(--gray-400);
            font-size: 0.9rem;
            line-height: 1.6;
            max-width: 300px;
        }

        footer .footer-bottom {
            border-top: 1px solid var(--gray-800);
            margin-top: 3rem;
            padding-top: 2rem;
            text-align: center;
            color: var(--gray-500);
            font-size: 0.85rem;
        }

        /* Alerts/Messages */
        .alert {
            border: none;
            border-radius: 0.5rem;
            font-size: 0.9rem;
        }

        .alert-success {
            background-color: #DCFCE7;
            color: #166534;
        }

        .alert-danger {
            background-color: #FEE2E2;
            color: #991B1B;
        }

        .alert-warning {
            background-color: #FEF3C7;
            color: #92400E;
        }

        .alert-info {
            background-color: var(--gray-100);
            color: var(--gray-700);
        }

        /* Form Controls - minimal overrides, let Bootstrap handle the rest */
        .form-control, .form-select {
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            font-size: 16px; /* Prevents zoom on iOS */
        }

        .form-control:focus, .form-select:focus {
            border-color: var(--gray-400);
            box-shadow: 0 0 0 3px rgba(0,0,0,0.05);
        }

        .form-label {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--gray-700);
            margin-bottom: 0.5rem;
        }

        /* Pagination */
        .pagination {
            gap: 0.25rem;
        }

        .page-link {
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            color: var(--gray-700);
            font-weight: 500;
            padding: 0.5rem 1rem;
        }

        .page-link:hover {
            background-color: var(--gray-100);
            border-color: var(--gray-300);
            color: var(--gray-900);
        }

        .page-item.active .page-link {
            background-color: var(--gray-900);
            border-color: var(--gray-900);
        }

        /* Utilities */
        .bg-alt {
            background-color: #FFFFFF;
        }

        .divider {
            height: 1px;
            background: var(--border-color);
            margin: 2rem 0;
        }

        /* Mobile Adjustments */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2.5rem;
            }

            .section {
                padding: 3rem 0;
            }

            .section-title {
                font-size: 1.25rem;
            }

            .listing-card .card-actions {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Loading skeleton */
        .skeleton {
            background: linear-gradient(90deg, var(--gray-100) 25%, var(--gray-200) 50%, var(--gray-100) 75%);
            background-size: 200% 100%;
            animation: skeleton-loading 1.5s infinite;
            border-radius: 0.375rem;
        }

        @keyframes skeleton-loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
    </style>

    {% block extra_css %}{% endblock %}
    {% block structured_data %}{% endblock %}
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg sticky-top">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="{% url 'home' %}">
                <img src="{% static 'images/logo-small.png' %}" alt="HeroesAndMore" height="45" class="me-2">
                <span class="fw-bold" style="font-size: 1.1rem; letter-spacing: -0.02em;">HeroesAndMore</span>
            </a>

            <button class="navbar-toggler border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <i class="bi bi-list fs-4"></i>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <!-- Search -->
                <form class="d-flex mx-auto search-container position-relative" action="{% url 'items:search' %}" method="get">
                    <input type="search" name="q" id="search-input" class="form-control search-input w-100"
                           placeholder="Search collectibles..." value="{{ request.GET.q|default:'' }}" autocomplete="off">
                    <div id="search-suggestions" class="position-absolute w-100 bg-white border rounded-bottom shadow-sm" style="display: none; top: 100%; left: 0; z-index: 1050; max-height: 300px; overflow-y: auto;"></div>
                </form>

                <ul class="navbar-nav align-items-center">
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'items:category_list' %}">Browse</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'marketplace:listing_list' %}">Marketplace</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'marketplace:platform_auctions' %}">Auctions</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'pricing:price_guide_list' %}">Price Guide</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'social:forum_index' %}">Community</a>
                    </li>

                    {% if user.is_authenticated %}
                        <li class="nav-item dropdown ms-2">
                            <a class="nav-link dropdown-toggle d-flex align-items-center gap-2" href="#" data-bs-toggle="dropdown">
                                {% if user.profile.avatar %}
                                    <img src="{{ user.profile.avatar.url }}" class="rounded-circle" width="28" height="28" style="object-fit: cover;">
                                {% else %}
                                    <div class="rounded-circle bg-dark text-white d-flex align-items-center justify-content-center" style="width: 28px; height: 28px; font-size: 0.75rem;">
                                        {{ user.username|slice:":1"|upper }}
                                    </div>
                                {% endif %}
                                <span class="d-none d-lg-inline">{{ user.username }}</span>
                            </a>
                            <ul class="dropdown-menu dropdown-menu-end">
                                <li><a class="dropdown-item" href="{% url 'accounts:dashboard' %}"><i class="bi bi-grid"></i> Dashboard</a></li>
                                <li><a class="dropdown-item" href="{% url 'accounts:profile' username=user.username %}"><i class="bi bi-person"></i> Profile</a></li>
                                <li><a class="dropdown-item" href="{% url 'collections:my_collections' %}"><i class="bi bi-collection"></i> Collections</a></li>
                                <li><a class="dropdown-item" href="{% url 'marketplace:my_listings' %}"><i class="bi bi-tag"></i> My Listings</a></li>
                                <li><a class="dropdown-item" href="{% url 'marketplace:my_orders' %}"><i class="bi bi-bag"></i> Orders</a></li>
                                <li><a class="dropdown-item" href="{% url 'alerts:wishlist_list' %}"><i class="bi bi-heart"></i> Wishlists</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="{% url 'seller_tools:dashboard' %}"><i class="bi bi-shop"></i> Seller Dashboard</a></li>
                                <li><a class="dropdown-item" href="{% url 'scanner:home' %}"><i class="bi bi-camera"></i> Scanner</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="{% url 'accounts:settings' %}"><i class="bi bi-gear"></i> Settings</a></li>
                                <li><a class="dropdown-item" href="{% url 'account_logout' %}"><i class="bi bi-box-arrow-right"></i> Sign Out</a></li>
                            </ul>
                        </li>
                        <li class="nav-item ms-1">
                            <a class="btn btn-ghost position-relative" href="{% url 'alerts:alerts_list' %}">
                                <i class="bi bi-bell fs-5"></i>
                                {% if unread_alerts_count %}
                                <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" style="font-size: 0.65rem;">
                                    {{ unread_alerts_count }}
                                </span>
                                {% endif %}
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="btn btn-ghost" href="{% url 'social:inbox' %}">
                                <i class="bi bi-chat-dots fs-5"></i>
                            </a>
                        </li>
                        <li class="nav-item ms-2">
                            <a class="btn btn-dark btn-sm" href="{% url 'marketplace:listing_create' %}">
                                <i class="bi bi-plus-lg me-1"></i> Sell
                            </a>
                        </li>
                    {% else %}
                        <li class="nav-item ms-2">
                            <a class="nav-link" href="{% url 'account_login' %}">Sign In</a>
                        </li>
                        <li class="nav-item ms-1">
                            <a class="btn btn-dark btn-sm" href="{% url 'account_signup' %}">Get Started</a>
                        </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

    <!-- Messages -->
    {% if messages %}
    <div class="container mt-3">
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <!-- Main Content -->
    <main>
        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-4 mb-4 mb-lg-0">
                    <span class="footer-brand">HEROESANDMORE</span>
                    <p class="footer-desc">The premier marketplace for collectors. Buy, sell, and track trading cards, comics, action figures, and more.</p>
                    <div class="d-flex gap-3 mt-3">
                        <a href="https://www.instagram.com/heroesandmoreofficial" target="_blank" rel="noopener" class="text-gray-400"><i class="bi bi-instagram fs-5"></i></a>
                        <a href="https://www.facebook.com/people/Heroesandmore/61587374366802/" target="_blank" rel="noopener" class="text-gray-400"><i class="bi bi-facebook fs-5"></i></a>
                        <a href="https://www.tiktok.com/@heroesandmoreofficial" target="_blank" rel="noopener" class="text-gray-400"><i class="bi bi-tiktok fs-5"></i></a>
                        <a href="https://youtube.com/@heroesandmore" target="_blank" rel="noopener" class="text-gray-400"><i class="bi bi-youtube fs-5"></i></a>
                        <a href="https://x.com/heroesam" target="_blank" rel="noopener" class="text-gray-400"><i class="bi bi-twitter-x fs-5"></i></a>
                    </div>
                </div>
                <div class="col-6 col-md-3 col-lg-2 mb-4 mb-lg-0">
                    <h6>Marketplace</h6>
                    <ul>
                        <li><a href="{% url 'marketplace:listing_list' %}">All Listings</a></li>
                        <li><a href="{% url 'marketplace:listing_list' %}?type=auction">Auctions</a></li>
                        <li><a href="{% url 'pricing:price_guide_list' %}">Price Guide</a></li>
                        <li><a href="{% url 'pricing:trending' %}">Trending</a></li>
                        <li><a href="{% url 'sell' %}">Sell Your Items</a></li>
                        <li><a href="{% url 'trusted_seller' %}">Trusted Seller Program</a></li>
                    </ul>
                </div>
                <div class="col-6 col-md-3 col-lg-2 mb-4 mb-lg-0">
                    <h6>Categories</h6>
                    <ul>
                        <li><a href="{% url 'items:category_list' %}">All Categories</a></li>
                        <li><a href="{% url 'marketplace:listing_list' %}?category=trading-cards">Trading Cards</a></li>
                        <li><a href="{% url 'marketplace:listing_list' %}?category=comics">Comics</a></li>
                        <li><a href="{% url 'marketplace:listing_list' %}?category=action-figures">Action Figures</a></li>
                    </ul>
                </div>
                <div class="col-6 col-md-3 col-lg-2 mb-4 mb-lg-0">
                    <h6>Tools</h6>
                    <ul>
                        <li><a href="{% url 'scanner:home' %}">Item Scanner</a></li>
                        <li><a href="{% url 'seller_tools:dashboard' %}">Seller Dashboard</a></li>
                        <li><a href="{% url 'seller_tools:import_list' %}">Bulk Import</a></li>
                        <li><a href="{% url 'collections:my_collections' %}">My Collections</a></li>
                    </ul>
                </div>
                <div class="col-6 col-md-3 col-lg-2">
                    <h6>Support</h6>
                    <ul>
                        <li><a href="{% url 'help' %}">Help Center</a></li>
                        <li><a href="{% url 'seller_guide' %}">Seller Guide</a></li>
                        <li><a href="{% url 'safety' %}">Safety Tips</a></li>
                        <li><a href="{% url 'contact' %}">Contact Us</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <div class="d-flex flex-wrap justify-content-center gap-3 mb-3">
                    <a href="{% url 'terms' %}">Terms of Service</a>
                    <a href="{% url 'privacy' %}">Privacy Policy</a>
                    <a href="{% url 'cookies' %}">Cookie Policy</a>
                </div>
                <small>&copy; {% now "Y" %} HeroesAndMore. All rights reserved.</small>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- HTMX -->
    <script src="https://unpkg.com/htmx.org@1.9.9"></script>
    <script>
    (function() {
        function getCookie(name) {
            const value = `; ${document.cookie}`;
            const parts = value.split(`; ${name}=`);
            if (parts.length === 2) return parts.pop().split(';').shift();
            return '';
        }

        document.body.addEventListener('htmx:configRequest', function(event) {
            event.detail.headers['X-CSRFToken'] = getCookie('csrftoken');
        });
    })();
    </script>

    <!-- Search Autocomplete -->
    <script>
    (function() {
        const searchInput = document.getElementById('search-input');
        const suggestionsBox = document.getElementById('search-suggestions');
        if (!searchInput || !suggestionsBox) return;

        let debounceTimer;
        let selectedIndex = -1;

        searchInput.addEventListener('input', function() {
            clearTimeout(debounceTimer);
            const query = this.value.trim();

            if (query.length < 2) {
                suggestionsBox.style.display = 'none';
                return;
            }

            debounceTimer = setTimeout(() => {
                fetch(`/items/autocomplete/?q=${encodeURIComponent(query)}`)
                    .then(r => r.json())
                    .then(data => {
                        if (data.suggestions.length === 0) {
                            suggestionsBox.style.display = 'none';
                            return;
                        }

                        selectedIndex = -1;
                        suggestionsBox.innerHTML = data.suggestions.map((s, i) => {
                            const icon = s.type === 'category' ? 'bi-folder' :
                                        s.type === 'price_guide' ? 'bi-graph-up' : 'bi-tag';
                            const typeLabel = s.type === 'category' ? 'Category' :
                                             s.type === 'price_guide' ? 'Price Guide' : '';
                            return `<div class="suggestion-item px-3 py-2 border-bottom" data-index="${i}" data-type="${s.type}" data-slug="${s.slug || ''}" style="cursor: pointer;">
                                <i class="bi ${icon} me-2 text-muted"></i>
                                <span>${s.text}</span>
                                ${typeLabel ? `<small class="text-muted float-end">${typeLabel}</small>` : ''}
                            </div>`;
                        }).join('');

                        suggestionsBox.style.display = 'block';

                        // Add click handlers
                        suggestionsBox.querySelectorAll('.suggestion-item').forEach(item => {
                            item.addEventListener('click', function() {
                                const type = this.dataset.type;
                                const slug = this.dataset.slug;
                                const text = this.querySelector('span').textContent;

                                if (type === 'category' && slug) {
                                    window.location.href = `/items/${slug}/`;
                                } else if (type === 'price_guide' && slug) {
                                    window.location.href = `/price-guide/item/${slug}/`;
                                } else {
                                    searchInput.value = text;
                                    searchInput.form.submit();
                                }
                            });
                            item.addEventListener('mouseenter', function() {
                                suggestionsBox.querySelectorAll('.suggestion-item').forEach(s => s.classList.remove('bg-light'));
                                this.classList.add('bg-light');
                            });
                        });
                    })
                    .catch(() => suggestionsBox.style.display = 'none');
            }, 200);
        });

        // Keyboard navigation
        searchInput.addEventListener('keydown', function(e) {
            const items = suggestionsBox.querySelectorAll('.suggestion-item');
            if (items.length === 0) return;

            if (e.key === 'ArrowDown') {
                e.preventDefault();
                selectedIndex = Math.min(selectedIndex + 1, items.length - 1);
                items.forEach((item, i) => item.classList.toggle('bg-light', i === selectedIndex));
            } else if (e.key === 'ArrowUp') {
                e.preventDefault();
                selectedIndex = Math.max(selectedIndex - 1, 0);
                items.forEach((item, i) => item.classList.toggle('bg-light', i === selectedIndex));
            } else if (e.key === 'Enter' && selectedIndex >= 0) {
                e.preventDefault();
                items[selectedIndex].click();
            } else if (e.key === 'Escape') {
                suggestionsBox.style.display = 'none';
            }
        });

        // Hide on click outside
        document.addEventListener('click', function(e) {
            if (!searchInput.contains(e.target) && !suggestionsBox.contains(e.target)) {
                suggestionsBox.style.display = 'none';
            }
        });
    })();
    </script>

    {% block extra_js %}{% endblock %}

    <!-- Clicky Analytics -->
    <script async data-id="101500548" src="/a91abe04d0a26f18d7.js"></script>
</body>
</html>
